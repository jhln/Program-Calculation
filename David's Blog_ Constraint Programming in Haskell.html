<!DOCTYPE html>
<html class='v2' dir='ltr' xmlns='http://www.w3.org/1999/xhtml' xmlns:b='http://www.google.com/2005/gml/b' xmlns:data='http://www.google.com/2005/gml/data' xmlns:expr='http://www.google.com/2005/gml/expr'>
<head>
<link href='https://www.blogger.com/static/v1/widgets/1667664774-css_bundle_v2.css' rel='stylesheet' type='text/css'/>
<script src='https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js'></script>
<script src='https://google-code-prettify.googlecode.com/svn/loader/lang-hs.js'></script>
<meta content='width=1100' name='viewport'/>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'/>
<meta content='blogger' name='generator'/>
<link href='https://overtond.blogspot.com/favicon.ico' rel='icon' type='image/x-icon'/>
<link href='http://overtond.blogspot.com/2008/07/pre.html' rel='canonical'/>
<link rel="alternate" type="application/atom+xml" title="David&#39;s Blog - Atom" href="https://overtond.blogspot.com/feeds/posts/default" />
<link rel="alternate" type="application/rss+xml" title="David&#39;s Blog - RSS" href="https://overtond.blogspot.com/feeds/posts/default?alt=rss" />
<link rel="service.post" type="application/atom+xml" title="David&#39;s Blog - Atom" href="https://www.blogger.com/feeds/1254792667029254313/posts/default" />

<link rel="alternate" type="application/atom+xml" title="David&#39;s Blog - Atom" href="https://overtond.blogspot.com/feeds/1151843562812398686/comments/default" />
<!--[if IE]><script type="text/javascript" src="https://www.blogger.com/static/v1/jsbin/403901366-ieretrofit.js"></script>
<![endif]-->
<meta content='http://overtond.blogspot.com/2008/07/pre.html' property='og:url'/>
<meta content='Constraint Programming in Haskell' property='og:title'/>
<meta content='Having had a bit of free time in the evenings lately, I&#39;ve finally got around to starting one of the things on my list of cool Haskell proje...' property='og:description'/>
<!--[if IE]> <script> (function() { var html5 = ("abbr,article,aside,audio,canvas,datalist,details," + "figure,footer,header,hgroup,mark,menu,meter,nav,output," + "progress,section,time,video").split(','); for (var i = 0; i < html5.length; i++) { document.createElement(html5[i]); } try { document.execCommand('BackgroundImageCache', false, true); } catch(e) {} })(); </script> <![endif]-->
<title>David's Blog: Constraint Programming in Haskell</title>
<style id='page-skin-1' type='text/css'><!--
/*
-----------------------------------------------
Blogger Template Style
Name:     Awesome Inc.
Designer: Tina Chen
URL:      tinachen.org
----------------------------------------------- */
/* Content
----------------------------------------------- */
body {
font: normal normal 13px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
background: #eeeeee none repeat scroll top left;
}
html body .content-outer {
min-width: 0;
max-width: 100%;
width: 100%;
}
a:link {
text-decoration: none;
color: #3778cd;
}
a:visited {
text-decoration: none;
color: #4d469c;
}
a:hover {
text-decoration: underline;
color: #3778cd;
}
.body-fauxcolumn-outer .cap-top {
position: absolute;
z-index: 1;
height: 276px;
width: 100%;
background: transparent none repeat-x scroll top left;
_background-image: none;
}
/* Columns
----------------------------------------------- */
.content-inner {
padding: 0;
}
.header-inner .section {
margin: 0 16px;
}
.tabs-inner .section {
margin: 0 16px;
}
.main-inner {
padding-top: 30px;
}
.main-inner .column-center-inner,
.main-inner .column-left-inner,
.main-inner .column-right-inner {
padding: 0 5px;
}
*+html body .main-inner .column-center-inner {
margin-top: -30px;
}
#layout .main-inner .column-center-inner {
margin-top: 0;
}
/* Header
----------------------------------------------- */
.header-outer {
margin: 0 0 0 0;
background: transparent none repeat scroll 0 0;
}
.Header h1 {
font: normal bold 40px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
text-shadow: 0 0 -1px #000000;
}
.Header h1 a {
color: #444444;
}
.Header .description {
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
}
.header-inner .Header .titlewrapper,
.header-inner .Header .descriptionwrapper {
padding-left: 0;
padding-right: 0;
margin-bottom: 0;
}
.header-inner .Header .titlewrapper {
padding-top: 22px;
}
/* Tabs
----------------------------------------------- */
.tabs-outer {
overflow: hidden;
position: relative;
background: #eeeeee url(//www.blogblog.com/1kt/awesomeinc/tabs_gradient_light.png) repeat scroll 0 0;
}
#layout .tabs-outer {
overflow: visible;
}
.tabs-cap-top, .tabs-cap-bottom {
position: absolute;
width: 100%;
border-top: 1px solid #999999;
}
.tabs-cap-bottom {
bottom: 0;
}
.tabs-inner .widget li a {
display: inline-block;
margin: 0;
padding: .6em 1.5em;
font: normal bold 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
border-top: 1px solid #999999;
border-bottom: 1px solid #999999;
border-left: 1px solid #999999;
height: 16px;
line-height: 16px;
}
.tabs-inner .widget li:last-child a {
border-right: 1px solid #999999;
}
.tabs-inner .widget li.selected a, .tabs-inner .widget li a:hover {
background: #666666 url(//www.blogblog.com/1kt/awesomeinc/tabs_gradient_light.png) repeat-x scroll 0 -100px;
color: #ffffff;
}
/* Headings
----------------------------------------------- */
h2 {
font: normal bold 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
}
/* Widgets
----------------------------------------------- */
.main-inner .section {
margin: 0 27px;
padding: 0;
}
.main-inner .column-left-outer,
.main-inner .column-right-outer {
margin-top: 0;
}
#layout .main-inner .column-left-outer,
#layout .main-inner .column-right-outer {
margin-top: 0;
}
.main-inner .column-left-inner,
.main-inner .column-right-inner {
background: transparent none repeat 0 0;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-goog-ms-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-moz-border-radius: 0;
-webkit-border-radius: 0;
-goog-ms-border-radius: 0;
border-radius: 0;
}
#layout .main-inner .column-left-inner,
#layout .main-inner .column-right-inner {
margin-top: 0;
}
.sidebar .widget {
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
}
.sidebar .widget a:link {
color: #3778cd;
}
.sidebar .widget a:visited {
color: #4d469c;
}
.sidebar .widget a:hover {
color: #3778cd;
}
.sidebar .widget h2 {
text-shadow: 0 0 -1px #000000;
}
.main-inner .widget {
background-color: #ffffff;
border: 1px solid #eeeeee;
padding: 0 15px 15px;
margin: 20px -16px;
-moz-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-goog-ms-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-moz-border-radius: 0;
-webkit-border-radius: 0;
-goog-ms-border-radius: 0;
border-radius: 0;
}
.main-inner .widget h2 {
margin: 0 -15px;
padding: .6em 15px .5em;
border-bottom: 1px solid transparent;
}
.footer-inner .widget h2 {
padding: 0 0 .4em;
border-bottom: 1px solid transparent;
}
.main-inner .widget h2 + div, .footer-inner .widget h2 + div {
border-top: 1px solid #eeeeee;
padding-top: 8px;
}
.main-inner .widget .widget-content {
margin: 0 -15px;
padding: 7px 15px 0;
}
.main-inner .widget ul, .main-inner .widget #ArchiveList ul.flat {
margin: -8px -15px 0;
padding: 0;
list-style: none;
}
.main-inner .widget #ArchiveList {
margin: -8px 0 0;
}
.main-inner .widget ul li, .main-inner .widget #ArchiveList ul.flat li {
padding: .5em 15px;
text-indent: 0;
color: #666666;
border-top: 1px solid #eeeeee;
border-bottom: 1px solid transparent;
}
.main-inner .widget #ArchiveList ul li {
padding-top: .25em;
padding-bottom: .25em;
}
.main-inner .widget ul li:first-child, .main-inner .widget #ArchiveList ul.flat li:first-child {
border-top: none;
}
.main-inner .widget ul li:last-child, .main-inner .widget #ArchiveList ul.flat li:last-child {
border-bottom: none;
}
.post-body {
position: relative;
}
.main-inner .widget .post-body ul {
padding: 0 2.5em;
margin: .5em 0;
list-style: disc;
}
.main-inner .widget .post-body ul li {
padding: 0.25em 0;
margin-bottom: .25em;
color: #444444;
border: none;
}
.footer-inner .widget ul {
padding: 0;
list-style: none;
}
.widget .zippy {
color: #666666;
}
/* Posts
----------------------------------------------- */
body .main-inner .Blog {
padding: 0;
margin-bottom: 1em;
background-color: transparent;
border: none;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, 0);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, 0);
-goog-ms-box-shadow: 0 0 0 rgba(0, 0, 0, 0);
box-shadow: 0 0 0 rgba(0, 0, 0, 0);
}
.main-inner .section:last-child .Blog:last-child {
padding: 0;
margin-bottom: 1em;
}
.main-inner .widget h2.date-header {
margin: 0 -15px 1px;
padding: 0 0 0 0;
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
background: transparent none no-repeat scroll top left;
border-top: 0 solid #eeeeee;
border-bottom: 1px solid transparent;
-moz-border-radius-topleft: 0;
-moz-border-radius-topright: 0;
-webkit-border-top-left-radius: 0;
-webkit-border-top-right-radius: 0;
border-top-left-radius: 0;
border-top-right-radius: 0;
position: static;
bottom: 100%;
right: 15px;
text-shadow: 0 0 -1px #000000;
}
.main-inner .widget h2.date-header span {
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
display: block;
padding: .5em 15px;
border-left: 0 solid #eeeeee;
border-right: 0 solid #eeeeee;
}
.date-outer {
position: relative;
margin: 30px 0 20px;
padding: 0 15px;
background-color: #ffffff;
border: 1px solid #eeeeee;
-moz-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-goog-ms-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-moz-border-radius: 0;
-webkit-border-radius: 0;
-goog-ms-border-radius: 0;
border-radius: 0;
}
.date-outer:first-child {
margin-top: 0;
}
.date-outer:last-child {
margin-bottom: 20px;
-moz-border-radius-bottomleft: 0;
-moz-border-radius-bottomright: 0;
-webkit-border-bottom-left-radius: 0;
-webkit-border-bottom-right-radius: 0;
-goog-ms-border-bottom-left-radius: 0;
-goog-ms-border-bottom-right-radius: 0;
border-bottom-left-radius: 0;
border-bottom-right-radius: 0;
}
.date-posts {
margin: 0 -15px;
padding: 0 15px;
clear: both;
}
.post-outer, .inline-ad {
border-top: 1px solid #eeeeee;
margin: 0 -15px;
padding: 15px 15px;
}
.post-outer {
padding-bottom: 10px;
}
.post-outer:first-child {
padding-top: 0;
border-top: none;
}
.post-outer:last-child, .inline-ad:last-child {
border-bottom: none;
}
.post-body {
position: relative;
}
.post-body img {
padding: 8px;
background: transparent;
border: 1px solid transparent;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-moz-border-radius: 0;
-webkit-border-radius: 0;
border-radius: 0;
}
h3.post-title, h4 {
font: normal bold 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
}
h3.post-title a {
font: normal bold 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
}
h3.post-title a:hover {
color: #3778cd;
text-decoration: underline;
}
.post-header {
margin: 0 0 1em;
}
.post-body {
line-height: 1.4;
}
.post-outer h2 {
color: #444444;
}
.post-footer {
margin: 1.5em 0 0;
}
#blog-pager {
padding: 15px;
font-size: 120%;
background-color: #ffffff;
border: 1px solid #eeeeee;
-moz-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-goog-ms-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-moz-border-radius: 0;
-webkit-border-radius: 0;
-goog-ms-border-radius: 0;
border-radius: 0;
-moz-border-radius-topleft: 0;
-moz-border-radius-topright: 0;
-webkit-border-top-left-radius: 0;
-webkit-border-top-right-radius: 0;
-goog-ms-border-top-left-radius: 0;
-goog-ms-border-top-right-radius: 0;
border-top-left-radius: 0;
border-top-right-radius-topright: 0;
margin-top: 1em;
}
.blog-feeds, .post-feeds {
margin: 1em 0;
text-align: center;
color: #444444;
}
.blog-feeds a, .post-feeds a {
color: #3778cd;
}
.blog-feeds a:visited, .post-feeds a:visited {
color: #4d469c;
}
.blog-feeds a:hover, .post-feeds a:hover {
color: #3778cd;
}
.post-outer .comments {
margin-top: 2em;
}
/* Comments
----------------------------------------------- */
.comments .comments-content .icon.blog-author {
background-repeat: no-repeat;
background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEgAACxIB0t1+/AAAAAd0SU1FB9sLFwMeCjjhcOMAAAD+SURBVDjLtZSvTgNBEIe/WRRnm3U8RC1neQdsm1zSBIU9VVF1FkUguQQsD9ITmD7ECZIJSE4OZo9stoVjC/zc7ky+zH9hXwVwDpTAWWLrgS3QAe8AZgaAJI5zYAmc8r0G4AHYHQKVwII8PZrZFsBFkeRCABYiMh9BRUhnSkPTNCtVXYXURi1FpBDgArj8QU1eVXUzfnjv7yP7kwu1mYrkWlU33vs1QNu2qU8pwN0UpKoqokjWwCztrMuBhEhmh8bD5UDqur75asbcX0BGUB9/HAMB+r32hznJgXy2v0sGLBcyAJ1EK3LFcbo1s91JeLwAbwGYu7TP/3ZGfnXYPgAVNngtqatUNgAAAABJRU5ErkJggg==);
}
.comments .comments-content .loadmore a {
border-top: 1px solid #999999;
border-bottom: 1px solid #999999;
}
.comments .continue {
border-top: 2px solid #999999;
}
/* Footer
----------------------------------------------- */
.footer-outer {
margin: -20px 0 -1px;
padding: 20px 0 0;
color: #444444;
overflow: hidden;
}
.footer-fauxborder-left {
border-top: 1px solid #eeeeee;
background: #ffffff none repeat scroll 0 0;
-moz-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-goog-ms-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
box-shadow: 0 0 20px rgba(0, 0, 0, .2);
margin: 0 -20px;
}
/* Mobile
----------------------------------------------- */
body.mobile {
background-size: auto;
}
.mobile .body-fauxcolumn-outer {
background: transparent none repeat scroll top left;
}
*+html body.mobile .main-inner .column-center-inner {
margin-top: 0;
}
.mobile .main-inner .widget {
padding: 0 0 15px;
}
.mobile .main-inner .widget h2 + div,
.mobile .footer-inner .widget h2 + div {
border-top: none;
padding-top: 0;
}
.mobile .footer-inner .widget h2 {
padding: 0.5em 0;
border-bottom: none;
}
.mobile .main-inner .widget .widget-content {
margin: 0;
padding: 7px 0 0;
}
.mobile .main-inner .widget ul,
.mobile .main-inner .widget #ArchiveList ul.flat {
margin: 0 -15px 0;
}
.mobile .main-inner .widget h2.date-header {
right: 0;
}
.mobile .date-header span {
padding: 0.4em 0;
}
.mobile .date-outer:first-child {
margin-bottom: 0;
border: 1px solid #eeeeee;
-moz-border-radius-topleft: 0;
-moz-border-radius-topright: 0;
-webkit-border-top-left-radius: 0;
-webkit-border-top-right-radius: 0;
-goog-ms-border-top-left-radius: 0;
-goog-ms-border-top-right-radius: 0;
border-top-left-radius: 0;
border-top-right-radius: 0;
}
.mobile .date-outer {
border-color: #eeeeee;
border-width: 0 1px 1px;
}
.mobile .date-outer:last-child {
margin-bottom: 0;
}
.mobile .main-inner {
padding: 0;
}
.mobile .header-inner .section {
margin: 0;
}
.mobile .post-outer, .mobile .inline-ad {
padding: 5px 0;
}
.mobile .tabs-inner .section {
margin: 0 10px;
}
.mobile .main-inner .widget h2 {
margin: 0;
padding: 0;
}
.mobile .main-inner .widget h2.date-header span {
padding: 0;
}
.mobile .main-inner .widget .widget-content {
margin: 0;
padding: 7px 0 0;
}
.mobile #blog-pager {
border: 1px solid transparent;
background: #ffffff none repeat scroll 0 0;
}
.mobile .main-inner .column-left-inner,
.mobile .main-inner .column-right-inner {
background: transparent none repeat 0 0;
-moz-box-shadow: none;
-webkit-box-shadow: none;
-goog-ms-box-shadow: none;
box-shadow: none;
}
.mobile .date-posts {
margin: 0;
padding: 0;
}
.mobile .footer-fauxborder-left {
margin: 0;
border-top: inherit;
}
.mobile .main-inner .section:last-child .Blog:last-child {
margin-bottom: 0;
}
.mobile-index-contents {
color: #444444;
}
.mobile .mobile-link-button {
background: #3778cd url(//www.blogblog.com/1kt/awesomeinc/tabs_gradient_light.png) repeat scroll 0 0;
}
.mobile-link-button a:link, .mobile-link-button a:visited {
color: #ffffff;
}
.mobile .tabs-inner .PageList .widget-content {
background: transparent;
border-top: 1px solid;
border-color: #999999;
color: #444444;
}
.mobile .tabs-inner .PageList .widget-content .pagelist-arrow {
border-left: 1px solid #999999;
}

--></style>
<style id='template-skin-1' type='text/css'><!--
body {
min-width: 960px;
}
.content-outer, .content-fauxcolumn-outer, .region-inner {
min-width: 960px;
max-width: 960px;
_width: 960px;
}
.main-inner .columns {
padding-left: 0;
padding-right: 310px;
}
.main-inner .fauxcolumn-center-outer {
left: 0;
right: 310px;
/* IE6 does not respect left and right together */
_width: expression(this.parentNode.offsetWidth -
parseInt("0") -
parseInt("310px") + 'px');
}
.main-inner .fauxcolumn-left-outer {
width: 0;
}
.main-inner .fauxcolumn-right-outer {
width: 310px;
}
.main-inner .column-left-outer {
width: 0;
right: 100%;
margin-left: -0;
}
.main-inner .column-right-outer {
width: 310px;
margin-right: -310px;
}
#layout {
min-width: 0;
}
#layout .content-outer {
min-width: 0;
width: 800px;
}
#layout .region-inner {
min-width: 0;
width: auto;
}
--></style>
<link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=1254792667029254313&amp;zx=aa60365b-4172-415e-bdef-54918779d3dc' media='none' onload='if(media!=&#39;all&#39;)media=&#39;all&#39;' rel='stylesheet'/><noscript><link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=1254792667029254313&amp;zx=aa60365b-4172-415e-bdef-54918779d3dc' rel='stylesheet'/></noscript>
<meta name='google-adsense-platform-account' content='ca-host-pub-1556223355139109'/>
<meta name='google-adsense-platform-domain' content='blogspot.com'/>

<script type="text/javascript" language="javascript">
  // Supply ads personalization default for EEA readers
  // See https://www.blogger.com/go/adspersonalization
  adsbygoogle = window.adsbygoogle || [];
  if (typeof adsbygoogle.requestNonPersonalizedAds === 'undefined') {
    adsbygoogle.requestNonPersonalizedAds = 1;
  }
</script>


</head>
<body class='loading variant-light'>
<div class='navbar section' id='navbar'><div class='widget Navbar' data-version='1' id='Navbar1'><script type="text/javascript">
    function setAttributeOnload(object, attribute, val) {
      if(window.addEventListener) {
        window.addEventListener('load',
          function(){ object[attribute] = val; }, false);
      } else {
        window.attachEvent('onload', function(){ object[attribute] = val; });
      }
    }
  </script>
<div id="navbar-iframe-container"></div>
<script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>
<script type="text/javascript">
      gapi.load("gapi.iframes:gapi.iframes.style.bubble", function() {
        if (gapi.iframes && gapi.iframes.getContext) {
          gapi.iframes.getContext().openChild({
              url: 'https://www.blogger.com/navbar.g?targetBlogID\x3d1254792667029254313\x26blogName\x3dDavid\x27s+Blog\x26publishMode\x3dPUBLISH_MODE_BLOGSPOT\x26navbarType\x3dLIGHT\x26layoutType\x3dLAYOUTS\x26searchRoot\x3dhttps://overtond.blogspot.com/search\x26blogLocale\x3den_GB\x26v\x3d2\x26homepageUrl\x3dhttps://overtond.blogspot.com/\x26targetPostID\x3d1151843562812398686\x26blogPostOrPageUrl\x3dhttps://overtond.blogspot.com/2008/07/pre.html\x26vt\x3d723751808406484476',
              where: document.getElementById("navbar-iframe-container"),
              id: "navbar-iframe"
          });
        }
      });
    </script><script type="text/javascript">
(function() {
var script = document.createElement('script');
script.type = 'text/javascript';
script.src = '//pagead2.googlesyndication.com/pagead/js/google_top_exp.js';
var head = document.getElementsByTagName('head')[0];
if (head) {
head.appendChild(script);
}})();
</script>
</div></div>
<div class='body-fauxcolumns'>
<div class='fauxcolumn-outer body-fauxcolumn-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<div class='content'>
<div class='content-fauxcolumns'>
<div class='fauxcolumn-outer content-fauxcolumn-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<div class='content-outer'>
<div class='content-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left content-fauxborder-left'>
<div class='fauxborder-right content-fauxborder-right'></div>
<div class='content-inner'>
<header>
<div class='header-outer'>
<div class='header-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left header-fauxborder-left'>
<div class='fauxborder-right header-fauxborder-right'></div>
<div class='region-inner header-inner'>
<div class='header section' id='header'><div class='widget Header' data-version='1' id='Header1'>
<div id='header-inner'>
<div class='titlewrapper'>
<h1 class='title'>
<a href='https://overtond.blogspot.com/'>
David's Blog
</a>
</h1>
</div>
<div class='descriptionwrapper'>
<p class='description'><span>
</span></p>
</div>
</div>
</div></div>
</div>
</div>
<div class='header-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</header>
<div class='tabs-outer'>
<div class='tabs-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left tabs-fauxborder-left'>
<div class='fauxborder-right tabs-fauxborder-right'></div>
<div class='region-inner tabs-inner'>
<div class='tabs no-items section' id='crosscol'></div>
<div class='tabs no-items section' id='crosscol-overflow'></div>
</div>
</div>
<div class='tabs-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='main-outer'>
<div class='main-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left main-fauxborder-left'>
<div class='fauxborder-right main-fauxborder-right'></div>
<div class='region-inner main-inner'>
<div class='columns fauxcolumns'>
<div class='fauxcolumn-outer fauxcolumn-center-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='fauxcolumn-outer fauxcolumn-left-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='fauxcolumn-outer fauxcolumn-right-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<!-- corrects IE6 width calculation -->
<div class='columns-inner'>
<div class='column-center-outer'>
<div class='column-center-inner'>
<div class='main section' id='main'><div class='widget Blog' data-version='1' id='Blog1'>
<div class='blog-posts hfeed'>

          <div class="date-outer">
        
<h2 class='date-header'><span>Thursday, 3 July 2008</span></h2>

          <div class="date-posts">
        
<div class='post-outer'>
<div class='post hentry uncustomized-post-template' itemprop='blogPost' itemscope='itemscope' itemtype='http://schema.org/BlogPosting'>
<meta content='1254792667029254313' itemprop='blogId'/>
<meta content='1151843562812398686' itemprop='postId'/>
<a name='1151843562812398686'></a>
<h3 class='post-title entry-title' itemprop='name'>
Constraint Programming in Haskell
</h3>
<div class='post-header'>
<div class='post-header-line-1'></div>
</div>
<div class='post-body entry-content' id='post-body-1151843562812398686' itemprop='description articleBody'>
<p>Having had a bit of free time in the evenings lately, I've finally got around to starting one of the things on my list of cool Haskell projects I'd like to get around to one day.  Since my time working on <a href="http://www.cs.mu.oz.au/research/mercury/">Mercury</a> and <a href="http://www.csse.monash.edu.au/~mbanda/hal/">HAL</a>, I've been interested in logic programming and constraint logic programming and I've been wanting to find out how close I can get to something that looks like a constraint logic programming system in Haskell.  </p><p>The Haskell list monad already allows a style of programming that feels somewhat like non-deterministic logic programming, with backtracking to do a depth-first left-to-right search.  I'm going to build a monad on top of the list monad to do finite domain constraint programming.  I'm aiming for a nice clean interface and a simple implementation, so this is not going to be as efficient as it could be, but that's ok for a proof of concept.  If I get time later, I'll go back and try to make it more efficient.</p><p>In a finite domain solver the variables represent a finite set of (usually integer) values to which the programmer can add various constraints. They are particularly useful for scheduling and timetabling problems. They are also good for solving puzzles such as Sudoku, which I will detail in a later post.</p><p>An example of the kind of constraint program we're aiming to be able to write is <pre class="prettyprint lang-hs"><span class='varid'>runTest</span> <span class='keyglyph'>=</span> <span class='varid'>runFD</span> <span class='varid'>test</span>

<span class='varid'>test</span> <span class='keyglyph'>=</span> <span class='keyword'>do</span>
    <span class='varid'>x</span> <span class='keyglyph'>&lt;-</span> <span class='varid'>newVar</span> <span class='keyglyph'>[</span><span class='num'>0</span><span class='keyglyph'>..</span><span class='num'>3</span><span class='keyglyph'>]</span>
    <span class='varid'>y</span> <span class='keyglyph'>&lt;-</span> <span class='varid'>newVar</span> <span class='keyglyph'>[</span><span class='num'>0</span><span class='keyglyph'>..</span><span class='num'>3</span><span class='keyglyph'>]</span>
    <span class='layout'>(</span><span class='layout'>(</span> <span class='varid'>x</span> <span class='varop'>.&lt;.</span> <span class='varid'>y</span><span class='layout'>)</span> <span class='varop'>`mplus`</span> <span class='layout'>(</span><span class='varid'>x</span> <span class='varop'>`same`</span> <span class='varid'>y</span><span class='layout'>)</span><span class='layout'>)</span>
    <span class='varid'>x</span> <span class='varop'>`hasValue`</span> <span class='num'>2</span>
    <span class='varid'>labelling</span> <span class='keyglyph'>[</span><span class='varid'>x</span><span class='layout'>,</span> <span class='varid'>y</span><span class='keyglyph'>]</span>
</pre>Here we create two finite domain variables <samp>x</samp> and <samp>y</samp>, each with an initial domain of <samp>{0, 1, 2, 3}</samp>. We then add a constraint that says either <samp>x</samp> is less than <samp>y</samp> or <samp>x</samp> is the same as <samp>y</samp>. We then further constrain <samp>x</samp> to have the value <samp>2</samp>. Finally, the call to <samp>labelling</samp> will search for all possible solutions that satisfy the given constraints. When we evaluate <samp>runTest</samp> we get the result <samp>[[2,3],[2,2]]</samp> which represents the two possible solutions <samp>{x = 2, y = 3}</samp> and <samp>{x = 2, y = 2}</samp>. </p><p>Finite domain solvers also allow constraints to contain arithmetic expressions involving constraint variables and integers. To keep things simple, we'll leave them out for now. The interface we are going to implement is shown below. </p><pre class="prettyprint lang-hs"><span class='comment'>{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span>
<span class='comment'>{-# LANGUAGE RankNTypes #-}</span>
<span class='keyword'>module</span> <span class='conid'>FD</span> <span class='layout'>(</span>
    <span class='comment'>-- Types</span>
    <span class='conid'>FD</span><span class='layout'>,</span>           <span class='comment'>-- Monad for finite domain constraint solver</span>
    <span class='conid'>FDVar</span><span class='layout'>,</span>        <span class='comment'>-- Finite domain solver variable</span>

    <span class='comment'>-- Functions</span>
    <span class='varid'>runFD</span><span class='layout'>,</span>        <span class='comment'>-- Run the monad and return a list of solutions.</span>
    <span class='varid'>newVar</span><span class='layout'>,</span>       <span class='comment'>-- Create a new FDVar</span>
    <span class='varid'>newVars</span><span class='layout'>,</span>      <span class='comment'>-- Create multiple FDVars</span>
    <span class='varid'>hasValue</span><span class='layout'>,</span>     <span class='comment'>-- Constrain a FDVar to a specific value</span>
    <span class='varid'>same</span><span class='layout'>,</span>         <span class='comment'>-- Constrain two FDVars to be the same</span>
    <span class='varid'>different</span><span class='layout'>,</span>    <span class='comment'>-- Constrain two FDVars to be different</span>
    <span class='varid'>allDifferent</span><span class='layout'>,</span> <span class='comment'>-- Constrain a list of FDVars to be different</span>
    <span class='layout'>(</span><span class='varop'>.&lt;.</span><span class='layout'>)</span><span class='layout'>,</span>        <span class='comment'>-- Constrain one FDVar to be less than another</span>
    <span class='varid'>labelling</span>     <span class='comment'>-- Backtracking search for all solutions</span>
    <span class='layout'>)</span> <span class='keyword'>where</span>
</pre>Modules we need to import: <pre class="prettyprint lang-hs"><span class='keyword'>import</span> <span class='conid'>Prelude</span> <span class='varid'>hiding</span> <span class='layout'>(</span><span class='varid'>lookup</span><span class='layout'>)</span>
<span class='keyword'>import</span> <span class='conid'>Control</span><span class='varop'>.</span><span class='conid'>Monad</span><span class='varop'>.</span><span class='conid'>State</span><span class='varop'>.</span><span class='conid'>Lazy</span>
<span class='keyword'>import</span> <span class='conid'>Control</span><span class='varop'>.</span><span class='conid'>Monad</span><span class='varop'>.</span><span class='conid'>Trans</span>
<span class='keyword'>import</span> <span class='keyword'>qualified</span> <span class='conid'>Data</span><span class='varop'>.</span><span class='conid'>Map</span> <span class='keyword'>as</span> <span class='conid'>Map</span>
<span class='keyword'>import</span> <span class='conid'>Data</span><span class='varop'>.</span><span class='conid'>Map</span> <span class='layout'>(</span><span class='layout'>(</span><span class='varop'>!</span><span class='layout'>)</span><span class='layout'>,</span> <span class='conid'>Map</span><span class='layout'>)</span>
<span class='keyword'>import</span> <span class='keyword'>qualified</span> <span class='conid'>Data</span><span class='varop'>.</span><span class='conid'>IntSet</span> <span class='keyword'>as</span> <span class='conid'>IntSet</span>
<span class='keyword'>import</span> <span class='conid'>Data</span><span class='varop'>.</span><span class='conid'>IntSet</span> <span class='layout'>(</span><span class='conid'>IntSet</span><span class='layout'>)</span>
</pre>Below we define the types for the solver. <pre class="prettyprint lang-hs"><span class='comment'>-- The FD monad</span>
<span class='keyword'>newtype</span> <span class='conid'>FD</span> <span class='varid'>s</span> <span class='varid'>a</span> <span class='keyglyph'>=</span> <span class='conid'>FD</span> <span class='layout'>{</span> <span class='varid'>unFD</span> <span class='keyglyph'>::</span> <span class='conid'>StateT</span> <span class='layout'>(</span><span class='conid'>FDState</span> <span class='varid'>s</span><span class='layout'>)</span> <span class='conid'>[]</span> <span class='varid'>a</span> <span class='layout'>}</span>
    <span class='keyword'>deriving</span> <span class='layout'>(</span><span class='conid'>Monad</span><span class='layout'>,</span> <span class='conid'>MonadPlus</span><span class='layout'>,</span> <span class='conid'>MonadState</span> <span class='layout'>(</span><span class='conid'>FDState</span> <span class='varid'>s</span><span class='layout'>)</span><span class='layout'>)</span>

<span class='comment'>-- FD variables</span>
<span class='keyword'>newtype</span> <span class='conid'>FDVar</span> <span class='varid'>s</span> <span class='keyglyph'>=</span> <span class='conid'>FDVar</span> <span class='layout'>{</span> <span class='varid'>unFDVar</span> <span class='keyglyph'>::</span> <span class='conid'>Int</span> <span class='layout'>}</span> <span class='keyword'>deriving</span> <span class='layout'>(</span><span class='conid'>Ord</span><span class='layout'>,</span> <span class='conid'>Eq</span><span class='layout'>)</span>

<span class='keyword'>type</span> <span class='conid'>VarSupply</span> <span class='varid'>s</span> <span class='keyglyph'>=</span> <span class='conid'>FDVar</span> <span class='varid'>s</span>
<span class='keyword'>data</span> <span class='conid'>VarInfo</span> <span class='varid'>s</span> <span class='keyglyph'>=</span> <span class='conid'>VarInfo</span>
     <span class='layout'>{</span> <span class='varid'>delayedConstraints</span> <span class='keyglyph'>::</span> <span class='conid'>FD</span> <span class='varid'>s</span> <span class='conid'>()</span><span class='layout'>,</span> <span class='varid'>values</span> <span class='keyglyph'>::</span> <span class='conid'>IntSet</span> <span class='layout'>}</span>
<span class='keyword'>type</span> <span class='conid'>VarMap</span> <span class='varid'>s</span> <span class='keyglyph'>=</span> <span class='conid'>Map</span> <span class='layout'>(</span><span class='conid'>FDVar</span> <span class='varid'>s</span><span class='layout'>)</span> <span class='layout'>(</span><span class='conid'>VarInfo</span> <span class='varid'>s</span><span class='layout'>)</span>
<span class='keyword'>data</span> <span class='conid'>FDState</span> <span class='varid'>s</span> <span class='keyglyph'>=</span> <span class='conid'>FDState</span>
     <span class='layout'>{</span> <span class='varid'>varSupply</span> <span class='keyglyph'>::</span> <span class='conid'>VarSupply</span> <span class='varid'>s</span><span class='layout'>,</span> <span class='varid'>varMap</span> <span class='keyglyph'>::</span> <span class='conid'>VarMap</span> <span class='varid'>s</span> <span class='layout'>}</span>
</pre><p>The type <samp class=haskell><span class='conid'>FD</span> s a</samp> is our constraint solver monad.  It contains a list monad to provide the search capability. This is wrapped in a <samp class=haskell><span class='conid'>StateT</span></samp> monad transformer which threads through the <em>constraint store</em> <samp class=haskell><span class=conid>FDState</span> s</samp>. The type variable <samp>s</samp> is a <em>phantom type</em>.  We will see later how this can be used to prevent any of the implementation detail "leaking out" of the monad.  </p><p>Our constraint store <samp class=haskell><span class=conid>FDState</span> s</samp> contains a supply of fresh constraint variables and also keeps track of the information we need to know about existing variables. For each existing variable we record its set of possible values (its <em>domain</em>) and a set of constraints on it. Whenever the domain of a variable changes, we need to execute its constraints to check that they are still satisfied. This, in turn, may further constrain the domain of other variables.  This is known as <em>constraint propagation</em>.</p><pre class="prettyprint lang-hs"><span class='comment'>-- Run the FD monad and produce a lazy list of possible solutions.</span>
<span class='varid'>runFD</span> <span class='keyglyph'>::</span> <span class='layout'>(</span><span class='keyword'>forall</span> <span class='varid'>s</span> <span class='varop'>.</span> <span class='conid'>FD</span> <span class='varid'>s</span> <span class='varid'>a</span><span class='layout'>)</span> <span class='keyglyph'>-&gt;</span> <span class='keyglyph'>[</span><span class='varid'>a</span><span class='keyglyph'>]</span>
<span class='varid'>runFD</span> <span class='varid'>fd</span> <span class='keyglyph'>=</span> <span class='varid'>evalStateT</span> <span class='layout'>(</span><span class='varid'>unFD</span> <span class='varid'>fd</span><span class='layout'>)</span> <span class='varid'>initState</span>

<span class='varid'>initState</span> <span class='keyglyph'>::</span> <span class='conid'>FDState</span> <span class='varid'>s</span>
<span class='varid'>initState</span> <span class='keyglyph'>=</span> <span class='conid'>FDState</span> <span class='layout'>{</span> <span class='varid'>varSupply</span> <span class='keyglyph'>=</span> <span class='conid'>FDVar</span> <span class='num'>0</span><span class='layout'>,</span> <span class='varid'>varMap</span> <span class='keyglyph'>=</span> <span class='conid'>Map</span><span class='varop'>.</span><span class='varid'>empty</span> <span class='layout'>}</span>
</pre><p>The function <samp>runFD</samp> runs a constraint solver, starting with an initially empty constraint store, and return a list of all possible solutions. The type <samp class=haskell><span class='layout'>(</span><span class='keyword'>forall</span> <span class='varid'>s</span> <span class='varop'>.</span> <span class='conid'>FD</span> <span class='varid'>s</span> <span class='varid'>a</span><span class='layout'>)</span> <span class='keyglyph'>-&gt;</span> <span class='keyglyph'>[</span><span class='varid'>a</span><span class='keyglyph'>]</span></samp> ensures that any values of a type containing the phantom type variable <samp>s</samp> can't "escape" from the monad. This means that we can't take a constraint variable from one monad and use it inside another one, thus ensuring, through the type system, that the monad is used safely.  <pre class="prettyprint lang-hs"><span class='comment'>-- Get a new FDVar</span>
<span class='varid'>newVar</span> <span class='keyglyph'>::</span> <span class='keyglyph'>[</span><span class='conid'>Int</span><span class='keyglyph'>]</span> <span class='keyglyph'>-&gt;</span> <span class='conid'>FD</span> <span class='varid'>s</span> <span class='layout'>(</span><span class='conid'>FDVar</span> <span class='varid'>s</span><span class='layout'>)</span>
<span class='varid'>newVar</span> <span class='varid'>domain</span><span class='keyglyph'>=</span> <span class='keyword'>do</span>
    <span class='varid'>v</span> <span class='keyglyph'>&lt;-</span> <span class='varid'>nextVar</span>
    <span class='varid'>v</span> <span class='varop'>`isOneOf`</span> <span class='varid'>domain</span>
    <span class='varid'>return</span> <span class='varid'>v</span>
    <span class='keyword'>where</span>
        <span class='varid'>nextVar</span> <span class='keyglyph'>::</span> <span class='conid'>FD</span> <span class='varid'>s</span> <span class='layout'>(</span><span class='conid'>FDVar</span> <span class='varid'>s</span><span class='layout'>)</span>
        <span class='varid'>nextVar</span> <span class='keyglyph'>=</span> <span class='keyword'>do</span>
            <span class='varid'>s</span> <span class='keyglyph'>&lt;-</span> <span class='varid'>get</span>
            <span class='keyword'>let</span> <span class='varid'>v</span> <span class='keyglyph'>=</span> <span class='varid'>varSupply</span> <span class='varid'>s</span>
            <span class='varid'>put</span> <span class='varop'>$</span> <span class='varid'>s</span> <span class='layout'>{</span> <span class='varid'>varSupply</span> <span class='keyglyph'>=</span> <span class='conid'>FDVar</span> <span class='layout'>(</span><span class='varid'>unFDVar</span> <span class='varid'>v</span> <span class='varop'>+</span> <span class='num'>1</span><span class='layout'>)</span> <span class='layout'>}</span>
            <span class='varid'>return</span> <span class='varid'>v</span>
        <span class='varid'>isOneOf</span> <span class='keyglyph'>::</span> <span class='conid'>FDVar</span> <span class='varid'>s</span> <span class='keyglyph'>-&gt;</span> <span class='keyglyph'>[</span><span class='conid'>Int</span><span class='keyglyph'>]</span> <span class='keyglyph'>-&gt;</span> <span class='conid'>FD</span> <span class='varid'>s</span> <span class='conid'>()</span>
        <span class='varid'>x</span> <span class='varop'>`isOneOf`</span> <span class='varid'>domain</span><span class='keyglyph'>=</span>
            <span class='varid'>modify</span> <span class='varop'>$</span> <span class='keyglyph'>\</span><span class='varid'>s</span> <span class='keyglyph'>-&gt;</span>
                <span class='keyword'>let</span> <span class='varid'>vm</span> <span class='keyglyph'>=</span> <span class='varid'>varMap</span> <span class='varid'>s</span>
                    <span class='varid'>vi</span> <span class='keyglyph'>=</span> <span class='conid'>VarInfo</span> <span class='layout'>{</span>
                        <span class='varid'>delayedConstraints</span> <span class='keyglyph'>=</span> <span class='varid'>return</span> <span class='conid'>()</span><span class='layout'>,</span>
                        <span class='varid'>values</span> <span class='keyglyph'>=</span> <span class='conid'>IntSet</span><span class='varop'>.</span><span class='varid'>fromList</span> <span class='varid'>domain</span><span class='layout'>}</span>
                <span class='keyword'>in</span>
                <span class='varid'>s</span> <span class='layout'>{</span> <span class='varid'>varMap</span> <span class='keyglyph'>=</span> <span class='conid'>Map</span><span class='varop'>.</span><span class='varid'>insert</span> <span class='varid'>x</span> <span class='varid'>vi</span> <span class='varid'>vm</span> <span class='layout'>}</span>

<span class='varid'>newVars</span> <span class='keyglyph'>::</span> <span class='conid'>Int</span> <span class='keyglyph'>-&gt;</span> <span class='keyglyph'>[</span><span class='conid'>Int</span><span class='keyglyph'>]</span> <span class='keyglyph'>-&gt;</span> <span class='conid'>FD</span> <span class='varid'>s</span> <span class='keyglyph'>[</span><span class='conid'>FDVar</span> <span class='varid'>s</span><span class='keyglyph'>]</span>
<span class='varid'>newVars</span> <span class='varid'>n</span> <span class='varid'>domain</span> <span class='keyglyph'>=</span> <span class='varid'>replicateM</span> <span class='varid'>n</span> <span class='layout'>(</span><span class='varid'>newVar</span> <span class='varid'>domain</span><span class='layout'>)</span>
</pre><p>The function <samp>newVar domain</samp> creates a new constraint variable constrained to values in <samp>domain</samp>. The function <samp>newVars n domain</samp> is a convenient way of creating multiple variables with the same domain.</p><p>Some helper functions which are not exported, but are used when we define the constraint functions: </p><pre class="prettyprint lang-hs"><span class='comment'>-- Lookup the current domain of a variable.</span>
<span class='varid'>lookup</span> <span class='keyglyph'>::</span> <span class='conid'>FDVar</span> <span class='varid'>s</span> <span class='keyglyph'>-&gt;</span> <span class='conid'>FD</span> <span class='varid'>s</span> <span class='conid'>IntSet</span>
<span class='varid'>lookup</span> <span class='varid'>x</span> <span class='keyglyph'>=</span> <span class='keyword'>do</span>
    <span class='varid'>s</span> <span class='keyglyph'>&lt;-</span> <span class='varid'>get</span>
    <span class='varid'>return</span> <span class='varop'>.</span> <span class='varid'>values</span> <span class='varop'>$</span> <span class='varid'>varMap</span> <span class='varid'>s</span> <span class='varop'>!</span> <span class='varid'>x</span>

<span class='comment'>-- Update the domain of a variable and fire all delayed constraints</span>
<span class='comment'>-- associated with that variable.</span>
<span class='varid'>update</span> <span class='keyglyph'>::</span> <span class='conid'>FDVar</span> <span class='varid'>s</span> <span class='keyglyph'>-&gt;</span> <span class='conid'>IntSet</span> <span class='keyglyph'>-&gt;</span> <span class='conid'>FD</span> <span class='varid'>s</span> <span class='conid'>()</span>
<span class='varid'>update</span> <span class='varid'>x</span> <span class='varid'>i</span> <span class='keyglyph'>=</span> <span class='keyword'>do</span>
    <span class='varid'>s</span> <span class='keyglyph'>&lt;-</span> <span class='varid'>get</span>
    <span class='keyword'>let</span> <span class='varid'>vm</span> <span class='keyglyph'>=</span> <span class='varid'>varMap</span> <span class='varid'>s</span>
    <span class='keyword'>let</span> <span class='varid'>vi</span> <span class='keyglyph'>=</span> <span class='varid'>vm</span> <span class='varop'>!</span> <span class='varid'>x</span>
    <span class='varid'>put</span> <span class='varop'>$</span> <span class='varid'>s</span> <span class='layout'>{</span> <span class='varid'>varMap</span> <span class='keyglyph'>=</span> <span class='conid'>Map</span><span class='varop'>.</span><span class='varid'>insert</span> <span class='varid'>x</span> <span class='layout'>(</span><span class='varid'>vi</span> <span class='layout'>{</span> <span class='varid'>values</span> <span class='keyglyph'>=</span> <span class='varid'>i</span><span class='layout'>}</span><span class='layout'>)</span> <span class='varid'>vm</span> <span class='layout'>}</span>
    <span class='varid'>delayedConstraints</span> <span class='varid'>vi</span>

<span class='comment'>-- Add a new constraint for a variable to the constraint store.</span>
<span class='varid'>addConstraint</span> <span class='keyglyph'>::</span> <span class='conid'>FDVar</span> <span class='varid'>s</span> <span class='keyglyph'>-&gt;</span> <span class='conid'>FD</span> <span class='varid'>s</span> <span class='conid'>()</span> <span class='keyglyph'>-&gt;</span> <span class='conid'>FD</span> <span class='varid'>s</span> <span class='conid'>()</span>
<span class='varid'>addConstraint</span> <span class='varid'>x</span> <span class='varid'>constraint</span> <span class='keyglyph'>=</span> <span class='keyword'>do</span>
    <span class='varid'>s</span> <span class='keyglyph'>&lt;-</span> <span class='varid'>get</span>
    <span class='keyword'>let</span> <span class='varid'>vm</span> <span class='keyglyph'>=</span> <span class='varid'>varMap</span> <span class='varid'>s</span>
    <span class='keyword'>let</span> <span class='varid'>vi</span> <span class='keyglyph'>=</span> <span class='varid'>vm</span> <span class='varop'>!</span> <span class='varid'>x</span>
    <span class='keyword'>let</span> <span class='varid'>cs</span> <span class='keyglyph'>=</span> <span class='varid'>delayedConstraints</span> <span class='varid'>vi</span>
    <span class='varid'>put</span> <span class='varop'>$</span> <span class='varid'>s</span> <span class='layout'>{</span> <span class='varid'>varMap</span> <span class='keyglyph'>=</span>
        <span class='conid'>Map</span><span class='varop'>.</span><span class='varid'>insert</span> <span class='varid'>x</span> <span class='layout'>(</span><span class='varid'>vi</span> <span class='layout'>{</span> <span class='varid'>delayedConstraints</span> <span class='keyglyph'>=</span> <span class='varid'>cs</span> <span class='varop'>&gt;&gt;</span> <span class='varid'>constraint</span> <span class='layout'>}</span><span class='layout'>)</span> <span class='varid'>vm</span> <span class='layout'>}</span>
 
<span class='comment'>-- Useful helper function for adding binary constraints between FDVars.</span>
<span class='keyword'>type</span> <span class='conid'>BinaryConstraint</span> <span class='varid'>s</span> <span class='keyglyph'>=</span> <span class='conid'>FDVar</span> <span class='varid'>s</span> <span class='keyglyph'>-&gt;</span> <span class='conid'>FDVar</span> <span class='varid'>s</span> <span class='keyglyph'>-&gt;</span> <span class='conid'>FD</span> <span class='varid'>s</span> <span class='conid'>()</span>
<span class='varid'>addBinaryConstraint</span> <span class='keyglyph'>::</span> <span class='conid'>BinaryConstraint</span> <span class='varid'>s</span> <span class='keyglyph'>-&gt;</span> <span class='conid'>BinaryConstraint</span> <span class='varid'>s</span>
<span class='varid'>addBinaryConstraint</span> <span class='varid'>f</span> <span class='varid'>x</span> <span class='varid'>y</span> <span class='keyglyph'>=</span> <span class='keyword'>do</span>
    <span class='keyword'>let</span> <span class='varid'>constraint</span>  <span class='keyglyph'>=</span> <span class='varid'>f</span> <span class='varid'>x</span> <span class='varid'>y</span>
    <span class='varid'>constraint</span>
    <span class='varid'>addConstraint</span> <span class='varid'>x</span> <span class='varid'>constraint</span>
    <span class='varid'>addConstraint</span> <span class='varid'>y</span> <span class='varid'>constraint</span>
</pre><p>The function <samp>lookup</samp> returns the current domain for a variable; <samp>update</samp> updates the domain for a variable and propagates the change into all constraints on that variable; <samp>addConstraint</samp> inserts a constraint into the constraint store; <samp>addBinaryConstraint</samp> tests a constraint on two variable and then adds it to the constraint store for each variable.</p><p>Now we can define the actual constraint functions:</p><pre class="prettyprint lang-hs"><span class='comment'>-- Constrain a variable to a particular value.</span>
<span class='varid'>hasValue</span> <span class='keyglyph'>::</span> <span class='conid'>FDVar</span> <span class='varid'>s</span> <span class='keyglyph'>-&gt;</span> <span class='conid'>Int</span> <span class='keyglyph'>-&gt;</span> <span class='conid'>FD</span> <span class='varid'>s</span> <span class='conid'>()</span>
<span class='varid'>var</span> <span class='varop'>`hasValue`</span> <span class='varid'>val</span> <span class='keyglyph'>=</span> <span class='keyword'>do</span>
    <span class='varid'>vals</span> <span class='keyglyph'>&lt;-</span> <span class='varid'>lookup</span> <span class='varid'>var</span>
    <span class='varid'>guard</span> <span class='varop'>$</span> <span class='varid'>val</span> <span class='varop'>`</span><span class='conid'>IntSet</span><span class='varop'>.</span><span class='varid'>member</span><span class='varop'>`</span> <span class='varid'>vals</span>
    <span class='keyword'>let</span> <span class='varid'>i</span> <span class='keyglyph'>=</span> <span class='conid'>IntSet</span><span class='varop'>.</span><span class='varid'>singleton</span> <span class='varid'>val</span>
    <span class='varid'>when</span> <span class='layout'>(</span><span class='varid'>i</span> <span class='varop'>/=</span> <span class='varid'>vals</span><span class='layout'>)</span> <span class='varop'>$</span> <span class='varid'>update</span> <span class='varid'>var</span> <span class='varid'>i</span>
</pre>In <samp>hasValue</samp> we lookup the current domain of the variable and test that the value to be set is within the domain. If the domain has changed, we update the constraint store and propagate the change. The other constraints are defined similarly: <pre class="prettyprint lang-hs"><span class='comment'>-- Constrain two variables to have the same value.</span>
<span class='varid'>same</span> <span class='keyglyph'>::</span> <span class='conid'>FDVar</span> <span class='varid'>s</span> <span class='keyglyph'>-&gt;</span> <span class='conid'>FDVar</span> <span class='varid'>s</span> <span class='keyglyph'>-&gt;</span> <span class='conid'>FD</span> <span class='varid'>s</span> <span class='conid'>()</span>
<span class='varid'>same</span> <span class='keyglyph'>=</span> <span class='varid'>addBinaryConstraint</span> <span class='varop'>$</span> <span class='keyglyph'>\</span><span class='varid'>x</span> <span class='varid'>y</span> <span class='keyglyph'>-&gt;</span> <span class='keyword'>do</span>
    <span class='varid'>xv</span> <span class='keyglyph'>&lt;-</span> <span class='varid'>lookup</span> <span class='varid'>x</span>
    <span class='varid'>yv</span> <span class='keyglyph'>&lt;-</span> <span class='varid'>lookup</span> <span class='varid'>y</span>
    <span class='keyword'>let</span> <span class='varid'>i</span> <span class='keyglyph'>=</span> <span class='conid'>IntSet</span><span class='varop'>.</span><span class='varid'>intersection</span> <span class='varid'>xv</span> <span class='varid'>yv</span>
    <span class='varid'>guard</span> <span class='varop'>$</span> <span class='varid'>not</span> <span class='varop'>$</span> <span class='conid'>IntSet</span><span class='varop'>.</span><span class='varid'>null</span> <span class='varid'>i</span>
    <span class='varid'>when</span> <span class='layout'>(</span><span class='varid'>i</span> <span class='varop'>/=</span> <span class='varid'>xv</span><span class='layout'>)</span> <span class='varop'>$</span> <span class='varid'>update</span> <span class='varid'>x</span> <span class='varid'>i</span>
    <span class='varid'>when</span> <span class='layout'>(</span><span class='varid'>i</span> <span class='varop'>/=</span> <span class='varid'>yv</span><span class='layout'>)</span> <span class='varop'>$</span> <span class='varid'>update</span> <span class='varid'>y</span> <span class='varid'>i</span>

<span class='comment'>-- Constrain two variables to have different values.</span>
<span class='varid'>different</span> <span class='keyglyph'>::</span> <span class='conid'>FDVar</span> <span class='varid'>s</span> <span class='keyglyph'>-&gt;</span> <span class='conid'>FDVar</span> <span class='varid'>s</span> <span class='keyglyph'>-&gt;</span> <span class='conid'>FD</span> <span class='varid'>s</span> <span class='conid'>()</span>
<span class='varid'>different</span> <span class='keyglyph'>=</span> <span class='varid'>addBinaryConstraint</span> <span class='varop'>$</span> <span class='keyglyph'>\</span><span class='varid'>x</span> <span class='varid'>y</span> <span class='keyglyph'>-&gt;</span> <span class='keyword'>do</span>
    <span class='varid'>xv</span> <span class='keyglyph'>&lt;-</span> <span class='varid'>lookup</span> <span class='varid'>x</span>
    <span class='varid'>yv</span> <span class='keyglyph'>&lt;-</span> <span class='varid'>lookup</span> <span class='varid'>y</span>
    <span class='varid'>guard</span> <span class='varop'>$</span> <span class='conid'>IntSet</span><span class='varop'>.</span><span class='varid'>size</span> <span class='varid'>xv</span> <span class='varop'>&gt;</span> <span class='num'>1</span> <span class='varop'>||</span> <span class='conid'>IntSet</span><span class='varop'>.</span><span class='varid'>size</span> <span class='varid'>yv</span> <span class='varop'>&gt;</span> <span class='num'>1</span> <span class='varop'>||</span> <span class='varid'>xv</span> <span class='varop'>/=</span> <span class='varid'>yv</span>

<span class='comment'>-- Constrain a list of variables to all have different values.</span>
<span class='varid'>allDifferent</span> <span class='keyglyph'>::</span> <span class='keyglyph'>[</span><span class='conid'>FDVar</span> <span class='varid'>s</span><span class='keyglyph'>]</span> <span class='keyglyph'>-&gt;</span> <span class='conid'>FD</span> <span class='varid'>s</span> <span class='conid'>()</span>
<span class='varid'>allDifferent</span> <span class='layout'>(</span><span class='varid'>x</span><span class='conop'>:</span><span class='varid'>xs</span><span class='layout'>)</span> <span class='keyglyph'>=</span> <span class='keyword'>do</span>
    <span class='varid'>mapM_</span> <span class='layout'>(</span><span class='varid'>different</span> <span class='varid'>x</span><span class='layout'>)</span> <span class='varid'>xs</span>
    <span class='varid'>allDifferent</span> <span class='varid'>xs</span>
<span class='varid'>allDifferent</span> <span class='keyword'>_</span> <span class='keyglyph'>=</span> <span class='varid'>return</span> <span class='conid'>()</span>

<span class='comment'>-- Constrain one variable to have a value less than the value of another</span>
<span class='comment'>-- variable.</span>
<span class='layout'>(</span><span class='varop'>.&lt;.</span><span class='layout'>)</span> <span class='keyglyph'>::</span> <span class='conid'>FDVar</span> <span class='varid'>s</span> <span class='keyglyph'>-&gt;</span> <span class='conid'>FDVar</span> <span class='varid'>s</span> <span class='keyglyph'>-&gt;</span> <span class='conid'>FD</span> <span class='varid'>s</span> <span class='conid'>()</span>
<span class='layout'>(</span><span class='varop'>.&lt;.</span><span class='layout'>)</span> <span class='keyglyph'>=</span> <span class='varid'>addBinaryConstraint</span> <span class='varop'>$</span> <span class='keyglyph'>\</span><span class='varid'>x</span> <span class='varid'>y</span> <span class='keyglyph'>-&gt;</span> <span class='keyword'>do</span>
    <span class='varid'>xv</span> <span class='keyglyph'>&lt;-</span> <span class='varid'>lookup</span> <span class='varid'>x</span>
    <span class='varid'>yv</span> <span class='keyglyph'>&lt;-</span> <span class='varid'>lookup</span> <span class='varid'>y</span>
    <span class='keyword'>let</span> <span class='varid'>xv'</span> <span class='keyglyph'>=</span> <span class='conid'>IntSet</span><span class='varop'>.</span><span class='varid'>filter</span> <span class='layout'>(</span><span class='varop'>&lt;</span> <span class='conid'>IntSet</span><span class='varop'>.</span><span class='varid'>findMax</span> <span class='varid'>yv</span><span class='layout'>)</span> <span class='varid'>xv</span>
    <span class='keyword'>let</span> <span class='varid'>yv'</span> <span class='keyglyph'>=</span> <span class='conid'>IntSet</span><span class='varop'>.</span><span class='varid'>filter</span> <span class='layout'>(</span><span class='varop'>&gt;</span> <span class='conid'>IntSet</span><span class='varop'>.</span><span class='varid'>findMin</span> <span class='varid'>xv</span><span class='layout'>)</span> <span class='varid'>yv</span>
    <span class='varid'>guard</span> <span class='varop'>$</span> <span class='varid'>not</span> <span class='varop'>$</span> <span class='conid'>IntSet</span><span class='varop'>.</span><span class='varid'>null</span> <span class='varid'>xv'</span>
    <span class='varid'>guard</span> <span class='varop'>$</span> <span class='varid'>not</span> <span class='varop'>$</span> <span class='conid'>IntSet</span><span class='varop'>.</span><span class='varid'>null</span> <span class='varid'>yv'</span>
    <span class='varid'>when</span> <span class='layout'>(</span><span class='varid'>xv</span> <span class='varop'>/=</span> <span class='varid'>xv'</span><span class='layout'>)</span> <span class='varop'>$</span> <span class='varid'>update</span> <span class='varid'>x</span> <span class='varid'>xv'</span>
    <span class='varid'>when</span> <span class='layout'>(</span><span class='varid'>yv</span> <span class='varop'>/=</span> <span class='varid'>yv'</span><span class='layout'>)</span> <span class='varop'>$</span> <span class='varid'>update</span> <span class='varid'>y</span> <span class='varid'>yv'</span>
</pre><p>Finally, in the <samp>labelling</samp> function we make use of the underlying list monad to search for all solutions for the given set of variables.</p><pre class="prettyprint lang-hs"><span class='comment'>-- Label variables using a depth-first left-to-right search.</span>
<span class='varid'>labelling</span> <span class='keyglyph'>::</span> <span class='keyglyph'>[</span><span class='conid'>FDVar</span> <span class='varid'>s</span><span class='keyglyph'>]</span> <span class='keyglyph'>-&gt;</span> <span class='conid'>FD</span> <span class='varid'>s</span> <span class='keyglyph'>[</span><span class='conid'>Int</span><span class='keyglyph'>]</span>
<span class='varid'>labelling</span> <span class='keyglyph'>=</span> <span class='varid'>mapM</span> <span class='varid'>label</span> <span class='keyword'>where</span>
    <span class='varid'>label</span> <span class='varid'>var</span> <span class='keyglyph'>=</span> <span class='keyword'>do</span>
        <span class='varid'>vals</span> <span class='keyglyph'>&lt;-</span> <span class='varid'>lookup</span> <span class='varid'>var</span>
        <span class='varid'>val</span> <span class='keyglyph'>&lt;-</span> <span class='conid'>FD</span> <span class='varop'>.</span> <span class='varid'>lift</span> <span class='varop'>$</span> <span class='conid'>IntSet</span><span class='varop'>.</span><span class='varid'>toList</span> <span class='varid'>vals</span>
        <span class='varid'>var</span> <span class='varop'>`hasValue`</span> <span class='varid'>val</span>
        <span class='varid'>return</span> <span class='varid'>val</span>
</pre>In a later posts I plan to show how to use this finite domain solver monad to write a solver for Sudoku puzzles, and extend the monad to support arithmetic expressions.
<div style='clear: both;'></div>
</div>
<div class='post-footer'>
<div class='post-footer-line post-footer-line-1'>
<span class='post-author vcard'>
Posted by
<span class='fn' itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'>
<meta content='https://www.blogger.com/profile/02945248194158818964' itemprop='url'/>
<a class='g-profile' href='https://www.blogger.com/profile/02945248194158818964' rel='author' title='author profile'>
<span itemprop='name'>Unknown</span>
</a>
</span>
</span>
<span class='post-timestamp'>
at
<meta content='http://overtond.blogspot.com/2008/07/pre.html' itemprop='url'/>
<a class='timestamp-link' href='https://overtond.blogspot.com/2008/07/pre.html' rel='bookmark' title='permanent link'><abbr class='published' itemprop='datePublished' title='2008-07-03T21:54:00+10:00'>21:54</abbr></a>
</span>
<span class='post-comment-link'>
</span>
<span class='post-icons'>
<span class='item-action'>
<a href='https://www.blogger.com/email-post.g?blogID=1254792667029254313&postID=1151843562812398686' title='Email Post'>
<img alt='' class='icon-action' height='13' src='https://resources.blogblog.com/img/icon18_email.gif' width='18'/>
</a>
</span>
<span class='item-control blog-admin pid-531983365'>
<a href='https://www.blogger.com/post-edit.g?blogID=1254792667029254313&postID=1151843562812398686&from=pencil' title='Edit Post'>
<img alt='' class='icon-action' height='18' src='https://resources.blogblog.com/img/icon18_edit_allbkg.gif' width='18'/>
</a>
</span>
</span>
<div class='post-share-buttons goog-inline-block'>
</div>
</div>
<div class='post-footer-line post-footer-line-2'>
<span class='post-labels'>
Labels:
<a href='https://overtond.blogspot.com/search/label/constraints' rel='tag'>constraints</a>,
<a href='https://overtond.blogspot.com/search/label/haskell' rel='tag'>haskell</a>,
<a href='https://overtond.blogspot.com/search/label/logic' rel='tag'>logic</a>,
<a href='https://overtond.blogspot.com/search/label/monads' rel='tag'>monads</a>,
<a href='https://overtond.blogspot.com/search/label/programming' rel='tag'>programming</a>
</span>
</div>
<div class='post-footer-line post-footer-line-3'>
<span class='post-location'>
</span>
</div>
</div>
</div>
<div class='comments' id='comments'>
<a name='comments'></a>
<h4>7 comments:</h4>
<div id='Blog1_comments-block-wrapper'>
<dl class='avatar-comment-indent' id='comments-block'>
<dt class='comment-author ' id='c8017443091235564433'>
<a name='c8017443091235564433'></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/02768287658329807075" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-8017443091235564433-02768287658329807075"><img src="//www.blogger.com/img/blogger_logo_round_35.png" width="35" height="35" alt="" title="Iamreddave">

</a></span></div>
<a href='https://www.blogger.com/profile/02768287658329807075' rel='nofollow'>Iamreddave</a>
said...
</dt>
<dd class='comment-body' id='Blog1_cmt-8017443091235564433'>
<p>
great post. I have been interested in  using functional programming to study logic programming since reading the escape from zurg paper.<BR/>http://lambda-the-ultimate.org/node/2434<BR/><BR/>I also am trying to work my way through the reasoned schemer which uses scheme to create minikanren a prolog like langauge.
</p>
</dd>
<dd class='comment-footer'>
<span class='comment-timestamp'>
<a href='https://overtond.blogspot.com/2008/07/pre.html?showComment=1215188580000#c8017443091235564433' title='comment permalink'>
5 July 2008 at 02:23
</a>
<span class='item-control blog-admin pid-528325584'>
<a class='comment-delete' href='https://www.blogger.com/delete-comment.g?blogID=1254792667029254313&postID=8017443091235564433' title='Delete Comment'>
<img src='https://resources.blogblog.com/img/icon_delete13.gif'/>
</a>
</span>
</span>
</dd>
<dt class='comment-author ' id='c8754641991276359110'>
<a name='c8754641991276359110'></a>
<div class="avatar-image-container vcard"><span dir="ltr"><a href="https://www.blogger.com/profile/06117980833354286046" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-8754641991276359110-06117980833354286046"><img src="https://resources.blogblog.com/img/blank.gif" width="35" height="35" class="delayLoad" style="display: none;" longdesc="//3.bp.blogspot.com/_amvk0sOTAw0/SaoruAdyUFI/AAAAAAAAACo/0iq7BE8-Twc/S45-s35/Imagen027.jpg" alt="" title="Saudade">

<noscript><img src="//3.bp.blogspot.com/_amvk0sOTAw0/SaoruAdyUFI/AAAAAAAAACo/0iq7BE8-Twc/S45-s35/Imagen027.jpg" width="35" height="35" class="photo" alt=""></noscript></a></span></div>
<a href='https://www.blogger.com/profile/06117980833354286046' rel='nofollow'>Saudade</a>
said...
</dt>
<dd class='comment-body' id='Blog1_cmt-8754641991276359110'>
<p>
Wow, very interesting work.<BR/><BR/>I've been programming constraint problem in the Mozart-oz language for years.<BR/><BR/>Now I use GECODE, a C++ library.<BR/><BR/>But you approachis very nice
</p>
</dd>
<dd class='comment-footer'>
<span class='comment-timestamp'>
<a href='https://overtond.blogspot.com/2008/07/pre.html?showComment=1215266760000#c8754641991276359110' title='comment permalink'>
6 July 2008 at 00:06
</a>
<span class='item-control blog-admin pid-2096605621'>
<a class='comment-delete' href='https://www.blogger.com/delete-comment.g?blogID=1254792667029254313&postID=8754641991276359110' title='Delete Comment'>
<img src='https://resources.blogblog.com/img/icon_delete13.gif'/>
</a>
</span>
</span>
</dd>
<dt class='comment-author ' id='c6676585271996924269'>
<a name='c6676585271996924269'></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/00018627183403149149" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-6676585271996924269-00018627183403149149"><img src="//www.blogger.com/img/blogger_logo_round_35.png" width="35" height="35" alt="" title="Unknown">

</a></span></div>
<a href='https://www.blogger.com/profile/00018627183403149149' rel='nofollow'>Unknown</a>
said...
</dt>
<dd class='comment-body' id='Blog1_cmt-6676585271996924269'>
<p>
<B>Nicely done!</B> Looks like constraints in Haskell is getting interest elsewhere as well. When searching for this post, I stumbled across: <A HREF="http://www.cs.cmu.edu/~damp/finalPapers/lam.pdf" REL="nofollow">A Concurrent Constraint Handling Rules Implementation in Haskell with Software Transactional Memory</A> I haven't read that yet, but you can <A HREF="http://taichi.ddns.comp.nus.edu.sg/taichiwiki/CCHR" REL="nofollow">download</A> an implementation to play with.
</p>
</dd>
<dd class='comment-footer'>
<span class='comment-timestamp'>
<a href='https://overtond.blogspot.com/2008/07/pre.html?showComment=1216338900000#c6676585271996924269' title='comment permalink'>
18 July 2008 at 09:55
</a>
<span class='item-control blog-admin pid-262862268'>
<a class='comment-delete' href='https://www.blogger.com/delete-comment.g?blogID=1254792667029254313&postID=6676585271996924269' title='Delete Comment'>
<img src='https://resources.blogblog.com/img/icon_delete13.gif'/>
</a>
</span>
</span>
</dd>
<dt class='comment-author ' id='c9100332792282553825'>
<a name='c9100332792282553825'></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/05945327727373203091" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-9100332792282553825-05945327727373203091"><img src="//www.blogger.com/img/blogger_logo_round_35.png" width="35" height="35" alt="" title="Michael Marte">

</a></span></div>
<a href='https://www.blogger.com/profile/05945327727373203091' rel='nofollow'>Michael Marte</a>
said...
</dt>
<dd class='comment-body' id='Blog1_cmt-9100332792282553825'>
<p>
Groundbreaking.<BR/>As the only way to inspect the constraint store is to enumerate all solutions, I developed some functions to display the constrained variables along with their domains, see my <A HREF="http://mmartedp.blogspot.com/" REL="nofollow">declarative-programming blog</A>.
</p>
</dd>
<dd class='comment-footer'>
<span class='comment-timestamp'>
<a href='https://overtond.blogspot.com/2008/07/pre.html?showComment=1224273360000#c9100332792282553825' title='comment permalink'>
18 October 2008 at 06:56
</a>
<span class='item-control blog-admin pid-313925599'>
<a class='comment-delete' href='https://www.blogger.com/delete-comment.g?blogID=1254792667029254313&postID=9100332792282553825' title='Delete Comment'>
<img src='https://resources.blogblog.com/img/icon_delete13.gif'/>
</a>
</span>
</span>
</dd>
<dt class='comment-author ' id='c4519919877236987549'>
<a name='c4519919877236987549'></a>
<div class="avatar-image-container vcard"><span dir="ltr"><a href="https://www.blogger.com/profile/05575578560152022579" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-4519919877236987549-05575578560152022579"><img src="https://resources.blogblog.com/img/blank.gif" width="35" height="35" class="delayLoad" style="display: none;" longdesc="//2.bp.blogspot.com/_Sh235RGes-w/SwBIu-GcX5I/AAAAAAAADic/4Mv7hKTkI4E/S45-s35/tom3.jpg" alt="" title="Tom Schrijvers">

<noscript><img src="//2.bp.blogspot.com/_Sh235RGes-w/SwBIu-GcX5I/AAAAAAAADic/4Mv7hKTkI4E/S45-s35/tom3.jpg" width="35" height="35" class="photo" alt=""></noscript></a></span></div>
<a href='https://www.blogger.com/profile/05575578560152022579' rel='nofollow'>Tom Schrijvers</a>
said...
</dt>
<dd class='comment-body' id='Blog1_cmt-4519919877236987549'>
<p>
David,<BR/><BR/>For our research on "Monadic Constraint Programming" we've used your FD library, and made a few modifications to it to fit it into our CP framework and to fix a bug (intervals around zero!). I hope you don't mind if we release the modified code. Is there some disclaimer or license you'd like us to include?<BR/><BR/>Cheers,<BR/><BR/>Tom
</p>
</dd>
<dd class='comment-footer'>
<span class='comment-timestamp'>
<a href='https://overtond.blogspot.com/2008/07/pre.html?showComment=1229429280000#c4519919877236987549' title='comment permalink'>
16 December 2008 at 23:08
</a>
<span class='item-control blog-admin pid-256966431'>
<a class='comment-delete' href='https://www.blogger.com/delete-comment.g?blogID=1254792667029254313&postID=4519919877236987549' title='Delete Comment'>
<img src='https://resources.blogblog.com/img/icon_delete13.gif'/>
</a>
</span>
</span>
</dd>
<dt class='comment-author ' id='c6539228523610784567'>
<a name='c6539228523610784567'></a>
<div class="avatar-image-container vcard"><span dir="ltr"><a href="https://www.blogger.com/profile/00252278540305284210" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-6539228523610784567-00252278540305284210"><img src="https://resources.blogblog.com/img/blank.gif" width="35" height="35" class="delayLoad" style="display: none;" longdesc="//1.bp.blogspot.com/-dkIc6f5N56s/U2ibyf4Bh5I/AAAAAAAABbc/sxP3CkF9CfE/s35/*" alt="" title="marco">

<noscript><img src="//1.bp.blogspot.com/-dkIc6f5N56s/U2ibyf4Bh5I/AAAAAAAABbc/sxP3CkF9CfE/s35/*" width="35" height="35" class="photo" alt=""></noscript></a></span></div>
<a href='https://www.blogger.com/profile/00252278540305284210' rel='nofollow'>marco</a>
said...
</dt>
<dd class='comment-body' id='Blog1_cmt-6539228523610784567'>
<span class='deleted-comment'>This comment has been removed by a blog administrator.</span>
</dd>
<dd class='comment-footer'>
<span class='comment-timestamp'>
<a href='https://overtond.blogspot.com/2008/07/pre.html?showComment=1236338160000#c6539228523610784567' title='comment permalink'>
6 March 2009 at 22:16
</a>
<span class='item-control blog-admin '>
<a class='comment-delete' href='https://www.blogger.com/delete-comment.g?blogID=1254792667029254313&postID=6539228523610784567' title='Delete Comment'>
<img src='https://resources.blogblog.com/img/icon_delete13.gif'/>
</a>
</span>
</span>
</dd>
<dt class='comment-author ' id='c3474958908094907024'>
<a name='c3474958908094907024'></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/09947295922054213581" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-3474958908094907024-09947295922054213581"><img src="//www.blogger.com/img/blogger_logo_round_35.png" width="35" height="35" alt="" title="James Goldstein">

</a></span></div>
<a href='https://www.blogger.com/profile/09947295922054213581' rel='nofollow'>James Goldstein</a>
said...
</dt>
<dd class='comment-body' id='Blog1_cmt-3474958908094907024'>
<p>
Thank you! I have been having trouble returning just one solution for systems which are very under-constrained.<br /><br />I tried &quot;take 1 (runFD test)&quot;, hoping to exploit the laziness of the state monad, but this in fact computed all solutions. What do I need to do?<br /><br />Thanks again
</p>
</dd>
<dd class='comment-footer'>
<span class='comment-timestamp'>
<a href='https://overtond.blogspot.com/2008/07/pre.html?showComment=1283187018637#c3474958908094907024' title='comment permalink'>
31 August 2010 at 02:50
</a>
<span class='item-control blog-admin pid-1366197651'>
<a class='comment-delete' href='https://www.blogger.com/delete-comment.g?blogID=1254792667029254313&postID=3474958908094907024' title='Delete Comment'>
<img src='https://resources.blogblog.com/img/icon_delete13.gif'/>
</a>
</span>
</span>
</dd>
</dl>
</div>
<p class='comment-footer'>
<a href='https://www.blogger.com/comment.g?blogID=1254792667029254313&postID=1151843562812398686' onclick=''>Post a Comment</a>
</p>
</div>
</div>

        </div></div>
      
</div>
<div class='blog-pager' id='blog-pager'>
<span id='blog-pager-newer-link'>
<a class='blog-pager-newer-link' href='https://overtond.blogspot.com/2008/07/haskell-sudoku-solver-using-finite.html' id='Blog1_blog-pager-newer-link' title='Newer Post'>Newer Post</a>
</span>
<span id='blog-pager-older-link'>
<a class='blog-pager-older-link' href='https://overtond.blogspot.com/2008/06/off-to-kiwiland.html' id='Blog1_blog-pager-older-link' title='Older Post'>Older Post</a>
</span>
<a class='home-link' href='https://overtond.blogspot.com/'>Home</a>
</div>
<div class='clear'></div>
<div class='post-feeds'>
<div class='feed-links'>
Subscribe to:
<a class='feed-link' href='https://overtond.blogspot.com/feeds/1151843562812398686/comments/default' target='_blank' type='application/atom+xml'>Post Comments (Atom)</a>
</div>
</div>
</div></div>
</div>
</div>
<div class='column-left-outer'>
<div class='column-left-inner'>
<aside>
</aside>
</div>
</div>
<div class='column-right-outer'>
<div class='column-right-inner'>
<aside>
<div class='sidebar section' id='sidebar-right-1'><div class='widget BlogArchive' data-version='1' id='BlogArchive1'>
<h2>Blog Archive</h2>
<div class='widget-content'>
<div id='ArchiveList'>
<div id='BlogArchive1_ArchiveList'>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://overtond.blogspot.com/2013/'>
2013
</a>
<span class='post-count' dir='ltr'>(4)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://overtond.blogspot.com/2013/10/'>
October
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://overtond.blogspot.com/2013/09/'>
September
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy toggle-open'>

        &#9660;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://overtond.blogspot.com/2008/'>
2008
</a>
<span class='post-count' dir='ltr'>(5)</span>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy toggle-open'>

        &#9660;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://overtond.blogspot.com/2008/07/'>
July
</a>
<span class='post-count' dir='ltr'>(2)</span>
<ul class='posts'>
<li><a href='https://overtond.blogspot.com/2008/07/haskell-sudoku-solver-using-finite.html'>A Haskell Sudoku Solver using Finite Domain Constr...</a></li>
<li><a href='https://overtond.blogspot.com/2008/07/pre.html'>Constraint Programming in Haskell</a></li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://overtond.blogspot.com/2008/06/'>
June
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://overtond.blogspot.com/2008/05/'>
May
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class='clear'></div>
</div>
</div></div>
<table border='0' cellpadding='0' cellspacing='0' class='section-columns columns-2'>
<tbody>
<tr>
<td class='first columns-cell'>
<div class='sidebar section' id='sidebar-right-2-1'><div class='widget Profile' data-version='1' id='Profile1'>
<h2>About Me</h2>
<div class='widget-content'>
<dl class='profile-datablock'>
<dt class='profile-data'>
<a class='profile-name-link g-profile' href='https://www.blogger.com/profile/02945248194158818964' rel='author' style='background-image: url(//www.blogger.com/img/logo-16.png);'>
Unknown
</a>
</dt>
</dl>
<a class='profile-link' href='https://www.blogger.com/profile/02945248194158818964' rel='author'>View my complete profile</a>
<div class='clear'></div>
</div>
</div></div>
</td>
<td class='columns-cell'>
<div class='sidebar no-items section' id='sidebar-right-2-2'></div>
</td>
</tr>
</tbody>
</table>
<div class='sidebar no-items section' id='sidebar-right-3'></div>
</aside>
</div>
</div>
</div>
<div style='clear: both'></div>
<!-- columns -->
</div>
<!-- main -->
</div>
</div>
<div class='main-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<footer>
<div class='footer-outer'>
<div class='footer-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left footer-fauxborder-left'>
<div class='fauxborder-right footer-fauxborder-right'></div>
<div class='region-inner footer-inner'>
<div class='foot no-items section' id='footer-1'></div>
<table border='0' cellpadding='0' cellspacing='0' class='section-columns columns-2'>
<tbody>
<tr>
<td class='first columns-cell'>
<div class='foot no-items section' id='footer-2-1'></div>
</td>
<td class='columns-cell'>
<div class='foot no-items section' id='footer-2-2'></div>
</td>
</tr>
</tbody>
</table>
<!-- outside of the include in order to lock Attribution widget -->
<div class='foot section' id='footer-3'><div class='widget Attribution' data-version='1' id='Attribution1'>
<div class='widget-content' style='text-align: center;'>
Awesome Inc. theme. Powered by <a href='https://www.blogger.com' target='_blank'>Blogger</a>.
</div>
<div class='clear'></div>
</div></div>
</div>
</div>
<div class='footer-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</footer>
<!-- content -->
</div>
</div>
<div class='content-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<script type='text/javascript'>
    window.setTimeout(function() {
        document.body.className = document.body.className.replace('loading', '');
      }, 10);
  </script>
<script src='https://apis.google.com/js/plusone.js' type='text/javascript'></script>
<!--Es liegt in deiner Verantwortung, deine Besucher \xfcber die in deinem Blog verwendeten Cookies und die dort erfassten Daten zu informieren. Blogger stellt daf\xfcr eine Standardbenachrichtigung zur Verf\xfcgung, die du \xfcbernehmen, anpassen oder durch deine eigene Mitteilung ersetzen kannst. Weitere Informationen findest du unter http://www.blogger.com/go/cookiechoices.-->
<script defer='' src='/js/cookienotice.js'></script>
<script>
    document.addEventListener('DOMContentLoaded', function(event) {
      window.cookieChoices && cookieChoices.showCookieConsentBar && cookieChoices.showCookieConsentBar(
          (window.cookieOptions && cookieOptions.msg) || 'Diese Website verwendet Cookies von Google, um Dienste anzubieten und Zugriffe zu analysieren. Deine IP-Adresse und dein User-Agent werden zusammen mit Messwerten zur Leistung und Sicherheit f\xfcr Google freigegeben. So k\xf6nnen Nutzungsstatistiken generiert, Missbrauchsf\xe4lle erkannt und behoben und die Qualit\xe4t des Dienstes gew\xe4hrleistet werden.',
          (window.cookieOptions && cookieOptions.close) || 'Ok',
          (window.cookieOptions && cookieOptions.learn) || 'Weitere Informationen',
          (window.cookieOptions && cookieOptions.link) || 'https://www.blogger.com/go/blogspot-cookies');
    });
  </script>

<script type="text/javascript" src="https://www.blogger.com/static/v1/widgets/4164007864-widgets.js"></script>
<script type='text/javascript'>
window['__wavt'] = 'AOuZoY6piaj_0D1Oi_7gOa8TAKoWCX27Ng:1632165218794';_WidgetManager._Init('//www.blogger.com/rearrange?blogID\x3d1254792667029254313','//overtond.blogspot.com/2008/07/pre.html','1254792667029254313');
_WidgetManager._SetDataContext([{'name': 'blog', 'data': {'blogId': '1254792667029254313', 'title': 'David\x27s Blog', 'url': 'https://overtond.blogspot.com/2008/07/pre.html', 'canonicalUrl': 'http://overtond.blogspot.com/2008/07/pre.html', 'homepageUrl': 'https://overtond.blogspot.com/', 'searchUrl': 'https://overtond.blogspot.com/search', 'canonicalHomepageUrl': 'http://overtond.blogspot.com/', 'blogspotFaviconUrl': 'https://overtond.blogspot.com/favicon.ico', 'bloggerUrl': 'https://www.blogger.com', 'hasCustomDomain': false, 'httpsEnabled': true, 'enabledCommentProfileImages': true, 'gPlusViewType': 'FILTERED_POSTMOD', 'adultContent': false, 'analyticsAccountNumber': '', 'encoding': 'UTF-8', 'locale': 'en-GB', 'localeUnderscoreDelimited': 'en_gb', 'languageDirection': 'ltr', 'isPrivate': false, 'isMobile': false, 'isMobileRequest': false, 'mobileClass': '', 'isPrivateBlog': false, 'isDynamicViewsAvailable': true, 'feedLinks': '\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22David\x26#39;s Blog - Atom\x22 href\x3d\x22https://overtond.blogspot.com/feeds/posts/default\x22 /\x3e\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/rss+xml\x22 title\x3d\x22David\x26#39;s Blog - RSS\x22 href\x3d\x22https://overtond.blogspot.com/feeds/posts/default?alt\x3drss\x22 /\x3e\n\x3clink rel\x3d\x22service.post\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22David\x26#39;s Blog - Atom\x22 href\x3d\x22https://www.blogger.com/feeds/1254792667029254313/posts/default\x22 /\x3e\n\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22David\x26#39;s Blog - Atom\x22 href\x3d\x22https://overtond.blogspot.com/feeds/1151843562812398686/comments/default\x22 /\x3e\n', 'meTag': '', 'adsenseHostId': 'ca-host-pub-1556223355139109', 'adsenseHasAds': false, 'adsenseAutoAds': false, 'ieCssRetrofitLinks': '\x3c!--[if IE]\x3e\x3cscript type\x3d\x22text/javascript\x22 src\x3d\x22https://www.blogger.com/static/v1/jsbin/403901366-ieretrofit.js\x22\x3e\x3c/script\x3e\n\x3c![endif]--\x3e', 'view': '', 'dynamicViewsCommentsSrc': '//www.blogblog.com/dynamicviews/4224c15c4e7c9321/js/comments.js', 'dynamicViewsScriptSrc': '//www.blogblog.com/dynamicviews/9d6213d09457aea4', 'plusOneApiSrc': 'https://apis.google.com/js/plusone.js', 'disableGComments': true, 'sharing': {'platforms': [{'name': 'Get link', 'key': 'link', 'shareMessage': 'Get link', 'target': ''}, {'name': 'Facebook', 'key': 'facebook', 'shareMessage': 'Share to Facebook', 'target': 'facebook'}, {'name': 'BlogThis!', 'key': 'blogThis', 'shareMessage': 'BlogThis!', 'target': 'blog'}, {'name': 'Twitter', 'key': 'twitter', 'shareMessage': 'Share to Twitter', 'target': 'twitter'}, {'name': 'Pinterest', 'key': 'pinterest', 'shareMessage': 'Share to Pinterest', 'target': 'pinterest'}, {'name': 'Email', 'key': 'email', 'shareMessage': 'Email', 'target': 'email'}], 'disableGooglePlus': true, 'googlePlusShareButtonWidth': 0, 'googlePlusBootstrap': '\x3cscript type\x3d\x22text/javascript\x22\x3ewindow.___gcfg \x3d {\x27lang\x27: \x27en_GB\x27};\x3c/script\x3e'}, 'hasCustomJumpLinkMessage': false, 'jumpLinkMessage': 'Read more', 'pageType': 'item', 'postId': '1151843562812398686', 'pageName': 'Constraint Programming in Haskell', 'pageTitle': 'David\x27s Blog: Constraint Programming in Haskell'}}, {'name': 'features', 'data': {'sharing_get_link_dialog': 'true', 'sharing_native': 'false'}}, {'name': 'messages', 'data': {'edit': 'Edit', 'linkCopiedToClipboard': 'Link copied to clipboard', 'ok': 'Ok', 'postLink': 'Post link'}}, {'name': 'template', 'data': {'name': 'custom', 'localizedName': 'Custom', 'isResponsive': false, 'isAlternateRendering': false, 'isCustom': true, 'variant': 'light', 'variantId': 'light'}}, {'name': 'view', 'data': {'classic': {'name': 'classic', 'url': '?view\x3dclassic'}, 'flipcard': {'name': 'flipcard', 'url': '?view\x3dflipcard'}, 'magazine': {'name': 'magazine', 'url': '?view\x3dmagazine'}, 'mosaic': {'name': 'mosaic', 'url': '?view\x3dmosaic'}, 'sidebar': {'name': 'sidebar', 'url': '?view\x3dsidebar'}, 'snapshot': {'name': 'snapshot', 'url': '?view\x3dsnapshot'}, 'timeslide': {'name': 'timeslide', 'url': '?view\x3dtimeslide'}, 'isMobile': false, 'title': 'Constraint Programming in Haskell', 'description': 'Having had a bit of free time in the evenings lately, I\x27ve finally got around to starting one of the things on my list of cool Haskell proje...', 'url': 'https://overtond.blogspot.com/2008/07/pre.html', 'type': 'item', 'isSingleItem': true, 'isMultipleItems': false, 'isError': false, 'isPage': false, 'isPost': true, 'isHomepage': false, 'isArchive': false, 'isLabelSearch': false, 'postId': 1151843562812398686}}]);
_WidgetManager._RegisterWidget('_NavbarView', new _WidgetInfo('Navbar1', 'navbar', document.getElementById('Navbar1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HeaderView', new _WidgetInfo('Header1', 'header', document.getElementById('Header1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogView', new _WidgetInfo('Blog1', 'main', document.getElementById('Blog1'), {'cmtInteractionsEnabled': false, 'lightboxEnabled': true, 'lightboxModuleUrl': 'https://www.blogger.com/static/v1/jsbin/592772849-lbx__en_gb.js', 'lightboxCssUrl': 'https://www.blogger.com/static/v1/v-css/4076883957-lightbox_bundle.css'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogArchiveView', new _WidgetInfo('BlogArchive1', 'sidebar-right-1', document.getElementById('BlogArchive1'), {'languageDirection': 'ltr', 'loadingMessage': 'Loading\x26hellip;'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_ProfileView', new _WidgetInfo('Profile1', 'sidebar-right-2-1', document.getElementById('Profile1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_AttributionView', new _WidgetInfo('Attribution1', 'footer-3', document.getElementById('Attribution1'), {}, 'displayModeFull'));
</script>
</body>
</html>